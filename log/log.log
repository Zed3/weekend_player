2015-05-07T10:44:49+03:00 DEBUG 
      SELECT id,
        IFNULL(vote,0) AS votes,
        IFNULL(last_played,0) AS last_played

      FROM weekendv2_list
      LEFT JOIN (
        SELECT song_id, IFNULL(SUM(value),0) AS vote
        FROM weekendv2_votes
        GROUP BY song_id
      ) AS votes USING(song_id)

      LEFT JOIN (
        SELECT song_id,TIMESTAMPDIFF(HOUR, timestamp, NOW()) AS last_played
        FROM weekendv2_list
        WHERE skip_reason = 'played'
        AND room_id = 1
        GROUP BY song_id
        ORDER BY timestamp DESC
      ) AS hour_diff USING(song_id)

      WHERE weekendv2_list.room_id=1
      AND id<119
      AND skip_reason = 'played'
      
      GROUP BY song_id
      
      ORDER BY RAND()
      LIMIT 1
    
